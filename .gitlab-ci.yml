stages:
  - mirror

mirror-to-github:
  stage: mirror
  when: manual
  variables:
    GIT_STRATEGY: none
  script:
    - rm -rf repo
    - git clone "http://gitlab:80/${CI_PROJECT_PATH}.git" repo
    - cd repo
    - git remote add github "https://${GITHUB_USERNAME}:${GITHUB_TOKEN}@github.com/${GITHUB_USERNAME}/${CI_PROJECT_NAME}.git"
    - git push --force github main
  only:
    - branches
    - tags