# Tripwire Auditd Rules - Track commands from decoy users
# These rules are generated by the install script based on config

# Track all execve calls from decoy users
# PLACEHOLDER: Install script will add user-specific rules here

# Track su/sudo attempts
-a always,exit -F arch=b64 -S execve -F path=/usr/bin/sudo -k tripwire_sudo
-a always,exit -F arch=b64 -S execve -F path=/usr/bin/su -k tripwire_su
-a always,exit -F arch=b32 -S execve -F path=/usr/bin/sudo -k tripwire_sudo
-a always,exit -F arch=b32 -S execve -F path=/usr/bin/su -k tripwire_su

# Track privilege escalation attempts
-a always,exit -F arch=b64 -S setuid -S setgid -S setreuid -S setregid -k tripwire_privesc
-a always,exit -F arch=b32 -S setuid -S setgid -S setreuid -S setregid -k tripwire_privesc
